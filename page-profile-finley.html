<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
<meta name="theme-color" content="#1b1d21" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<title>Finley Profile - QuoVadis</title>
<link rel="stylesheet" type="text/css" href="styles/bootstrap.css">
<link rel="stylesheet" type="text/css" href="styles/style.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i|Source+Sans+Pro:300,300i,400,400i,600,600i,700,700i,900,900i&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="fonts/css/fontawesome-all.min.css">
<link rel="manifest" href="/manifest.json" data-pwa-version="set_in_manifest_and_pwa_js">
<link rel="apple-touch-icon" sizes="180x180" href="app/icons/icon-192x192.png">
</head>

<body class="theme-dark" data-highlight="highlight-blue" data-gradient="body-default">

<div id="preloader"><div class="spinner-border color-highlight" role="status"></div></div>

<div id="page">

    <!-- Footer Navigation -->
    <div id="footer-bar" class="footer-bar-1">
        <a href="page-dfb.html"><i class="fa fa-running"></i><span>DFB</span></a>
        <a href="page-profile-finley.html" class="active-nav"><i class="fa fa-futbol"></i><span>Finley</span></a>
        <a href="index.html"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="page-videos.html"><i class="fa fa-video"></i><span>Videos</span></a>
        <a href="#" data-menu="menu-settings"><i class="fa fa-cog"></i><span>Settings</span></a>
    </div>

    <!-- Page Content -->
    <div class="page-content">
        <div class="page-content header-clear-small">

            <!-- Page Title -->
            <div class="card card-style">
                <div class="content">
                    <h1 class="mb-0">Finley Profile</h1>
                    <p class="color-highlight mb-2">Football Training Videos</p>
                </div>
            </div>

            <!-- Mini Dashboard Card -->
            <div class="card card-style gradient-blue" style="position: relative;">
                <!-- Timer Control Button (Toggle) -->
                <button id="timer-toggle-btn" class="color-white" style="position: absolute; top: 85px; left: 16.66%; transform: translateX(-50%); z-index: 10; background: none; border: none; font-size: 3rem; font-weight: 900; cursor: pointer; opacity: 0.9;">
                    <i id="timer-toggle-icon" class="fa fa-play"></i>
                </button>

                <div class="content pt-4 pb-4">
                    <h3 class="mb-3 color-white text-center">Training Dashboard</h3>

                    <!-- Timer Display -->
                    <div class="text-center mb-4">
                        <div id="timer-display" class="color-white" style="font-size: 4rem; font-weight: 900; line-height: 1;">15s</div>
                        <p class="color-white opacity-80 mb-0" style="font-size: 0.9rem;">Session Timer</p>
                    </div>

                    <!-- Dashboard Stats Row -->
                    <div class="row text-center">
                        <div class="col-4">
                            <div class="color-white" style="font-size: 1.5rem; font-weight: 700;">1/6</div>
                            <p class="color-white opacity-70 mb-0" style="font-size: 0.8rem;">Exercises</p>
                        </div>
                        <div class="col-4">
                            <div class="color-white" style="font-size: 1.5rem; font-weight: 700;">2:45</div>
                            <p class="color-white opacity-70 mb-0" style="font-size: 0.8rem;">Duration</p>
                        </div>
                        <div class="col-4">
                            <div class="color-white" style="font-size: 1.5rem; font-weight: 700;">85%</div>
                            <p class="color-white opacity-70 mb-0" style="font-size: 0.8rem;">Progress</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Video Card with Custom Player -->
            <div class="card card-style">
                <div class="content">
                    <div class="custom-video-player" style="position: relative; background: #000; border-radius: 10px; overflow: hidden;">
                        <video
                            id="main-video"
                            style="width: 100%; height: 300px; display: block; object-fit: cover;"
                            crossorigin="anonymous">
                            <source src="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000002092%20V1-0001.mp4" type="video/mp4">
                            Your browser doesn't support HTML5 video.
                        </video>

                        <!-- Video Title Overlay -->
                        <div id="video-title" style="position: absolute; top: 15px; left: 15px; z-index: 15; color: white; font-size: 1.5rem; font-weight: 700; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">Übung 1</div>

                        <!-- Custom Play/Pause Button -->
                        <div class="custom-controls" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); transition: opacity 0.3s ease;">
                            <button id="play-pause-btn" class="play-pause-button" style="
                                background: rgba(255,255,255,0.9);
                                border: none;
                                border-radius: 50%;
                                width: 80px;
                                height: 80px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                            ">
                                <i id="play-pause-icon" class="fa fa-play" style="font-size: 28px; color: #333; margin-left: 4px;"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Finley Performance Metrics -->
            <div class="card card-style">
                <div class="content">
                    <h3>Performance Metrics</h3>
                    <div class="row mb-0">
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card bg-highlight loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" data-video="1" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000002092%20V1-0001.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 1</h5>
                                    <p class="text-white-50 mb-0">Sprint Training</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" data-video="2" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000003176%20V1-0002.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 2</h5>
                                    <p class="text-white-50 mb-0">Agility Training</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12"><div class="divider mt-2 mb-4"></div></div>
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" data-video="4" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000005572%20V1-0004.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 4</h5>
                                    <p class="text-white-50 mb-0">Ball Control</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" data-video="5" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000007004%20V1-0005.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 5</h5>
                                    <p class="text-white-50 mb-0">Dribbling</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12"><div class="divider mt-2 mb-4"></div></div>
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" data-video="6" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000008268%20V1-0006.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 6</h5>
                                    <p class="text-white-50 mb-0">Finishing</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card card-style m-0 exercise-card loading-card" data-card-height="140" style="cursor: pointer; background-size: cover; background-position: center; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" data-video="7" data-url="https://videos-data.fra1.cdn.digitaloceanspaces.com/Untitled%201%2000009594%20V1-0007.mp4">
                                <div class="loading-overlay">
                                    <div class="spinner-border spinner-border-sm text-white" role="status"></div>
                                </div>
                                <div class="card-overlay">
                                    <h5 class="text-white font-weight-bold">Übung 7</h5>
                                    <p class="text-white-50 mb-0">Coordination</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



        </div>
    </div>

    <!-- Settings Menu -->
    <div id="menu-settings" class="menu menu-box-bottom menu-box-detached">
        <div class="menu-title"><h1>Settings</h1><a href="#" class="close-menu"><i class="fa fa-times"></i></a></div>
        <div class="content">
            <div class="list-group list-custom-small">
                <a href="#" data-toggle-theme class="pb-2 ms-n1">
                    <i class="fa font-12 fa-moon rounded-s bg-highlight color-white me-3"></i>
                    <span>Dark Mode</span>
                    <div class="custom-control scale-switch ios-switch">
                        <input data-toggle-theme type="checkbox" class="ios-input" id="switch-dark-mode">
                        <label class="custom-control-label" for="switch-dark-mode"></label>
                    </div>
                    <i class="fa fa-angle-right"></i>
                </a>
                <a href="#" id="fullscreen-toggle" class="pb-2 ms-n1">
                    <i class="fa font-12 fa-expand rounded-s bg-blue-dark color-white me-3"></i>
                    <span>Fullscreen Mode</span>
                    <div class="custom-control scale-switch ios-switch">
                        <input type="checkbox" class="ios-input" id="switch-fullscreen-mode">
                        <label class="custom-control-label" for="switch-fullscreen-mode"></label>
                    </div>
                    <i class="fa fa-angle-right"></i>
                </a>
            </div>
        </div>
    </div>

</div>

<!-- Exercise Card Styles -->
<style>
.loading-card {
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

.loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: opacity 0.3s ease;
}

.loading-card.loaded .loading-overlay {
    opacity: 0;
    pointer-events: none;
}

.card-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
    padding: 15px;
    z-index: 5;
}

.exercise-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.exercise-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
}

.exercise-card.bg-highlight {
    border: 3px solid #007bff;
    box-shadow: 0 0 20px rgba(0, 123, 255, 0.3);
}

/* Fallback gradients for different exercise types */
.exercise-card[data-video="1"] {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%) !important;
}

.exercise-card[data-video="2"] {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
}

.exercise-card[data-video="4"] {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%) !important;
}

.exercise-card[data-video="5"] {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%) !important;
}

.exercise-card[data-video="6"] {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
}

.exercise-card[data-video="7"] {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%) !important;
}

/* When thumbnail is loaded, override the gradient */
.exercise-card.loaded {
    background-size: cover !important;
    background-position: center !important;
}
</style>

<script type="text/javascript" src="scripts/bootstrap.min.js"></script>
<script type="text/javascript" src="scripts/custom.js"></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    'use strict'

    console.log('🎯 Finley Profile Page Loaded Successfully');

    // Get elements
    const mainVideo = document.getElementById('main-video');
    const videoTitle = document.getElementById('video-title');
    const exerciseCards = document.querySelectorAll('.exercise-card');
    const playPauseBtn = document.getElementById('play-pause-btn');
    const playPauseIcon = document.getElementById('play-pause-icon');
    const customControls = document.querySelector('.custom-controls');

    // Timer elements
    const timerDisplay = document.getElementById('timer-display');
    const timerToggleBtn = document.getElementById('timer-toggle-btn');
    const timerToggleIcon = document.getElementById('timer-toggle-icon');

    console.log('Found elements:', {
        mainVideo: !!mainVideo,
        videoTitle: !!videoTitle,
        exerciseCards: exerciseCards.length,
        playPauseBtn: !!playPauseBtn,
        customControls: !!customControls,
        timerDisplay: !!timerDisplay,
        timerToggleBtn: !!timerToggleBtn,
        timerToggleIcon: !!timerToggleIcon
    });

    // Timer functionality
    let timerSeconds = 15;
    let timerInterval = null;
    let isTimerRunning = false;
    let currentExercise = 1;
    const totalExercises = 6;

    function updateTimerDisplay() {
        timerDisplay.textContent = `${timerSeconds}s`;
    }

    function updateExerciseCounter() {
        const exerciseCounterElement = document.querySelector('.row.text-center .col-4:first-child .color-white');
        if (exerciseCounterElement) {
            exerciseCounterElement.textContent = `${currentExercise}/${totalExercises}`;
        }
    }

    function updateToggleButton() {
        if (isTimerRunning) {
            timerToggleIcon.className = 'fa fa-pause';
        } else {
            timerToggleIcon.className = 'fa fa-play';
        }
    }

    function startTimer() {
        if (!isTimerRunning && timerSeconds > 0) {
            isTimerRunning = true;
            updateToggleButton();
            console.log('⏱️ Timer started');

            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();

                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    updateToggleButton();
                    console.log('⏰ Timer finished!');

                    // Increment exercise counter if not at max
                    if (currentExercise < totalExercises) {
                        currentExercise++;
                        updateExerciseCounter();
                        console.log(`📈 Exercise incremented to ${currentExercise}/${totalExercises}`);
                    }

                    // Add completion effect and reset timer
                    timerDisplay.style.color = '#ff6b6b';
                    setTimeout(() => {
                        timerDisplay.style.color = '';
                        timerSeconds = 15;
                        updateTimerDisplay();
                        console.log('🔄 Timer reset to 15s');
                    }, 2000);
                }
            }, 1000);
        }
    }

    function pauseTimer() {
        if (isTimerRunning) {
            clearInterval(timerInterval);
            isTimerRunning = false;
            updateToggleButton();
            console.log('⏸️ Timer paused');
        }
    }

    function resetTimer() {
        clearInterval(timerInterval);
        isTimerRunning = false;
        timerSeconds = 15;
        updateTimerDisplay();
        updateToggleButton();
        console.log('🔄 Timer reset');
    }

    function toggleTimer() {
        if (isTimerRunning) {
            pauseTimer();
        } else {
            startTimer();
        }
    }

    // Timer toggle button event listener
    if (timerToggleBtn) {
        timerToggleBtn.addEventListener('click', function() {
            toggleTimer();
        });
    }

    // Function to extract video thumbnail with improved error handling
    function extractThumbnail(videoUrl, card) {
        const loadingOverlay = card.querySelector('.loading-overlay');
        const videoNumber = card.getAttribute('data-video');

        console.log(`🖼️ Starting thumbnail extraction for video ${videoNumber}:`, videoUrl);

        const video = document.createElement('video');
        video.crossOrigin = 'anonymous';
        video.muted = true;
        video.preload = 'metadata';
        video.playsInline = true;

        // Set timeout for thumbnail extraction
        const timeoutId = setTimeout(() => {
            console.warn(`⏰ Thumbnail extraction timeout for video ${videoNumber}`);
            finalizeThumbnailLoading(card, false);
        }, 10000); // 10 second timeout

        video.addEventListener('loadedmetadata', function() {
            console.log(`📊 Video metadata loaded for video ${videoNumber}`);
            // Seek to 1 second into the video for a better thumbnail
            video.currentTime = Math.min(1, video.duration * 0.1);
        });

        video.addEventListener('seeked', function() {
            try {
                console.log(`🎯 Video seeked for video ${videoNumber}, extracting frame...`);

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                // Set canvas dimensions
                canvas.width = video.videoWidth || 640;
                canvas.height = video.videoHeight || 360;

                // Draw video frame to canvas
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                // Convert to data URL
                const thumbnailUrl = canvas.toDataURL('image/jpeg', 0.8);

                // Apply thumbnail
                card.style.backgroundImage = `url(${thumbnailUrl})`;
                card.classList.add('loaded');

                clearTimeout(timeoutId);
                finalizeThumbnailLoading(card, true);

                console.log(`✅ Thumbnail extracted successfully for video ${videoNumber}`);
            } catch (error) {
                console.error(`❌ Error extracting thumbnail for video ${videoNumber}:`, error);
                clearTimeout(timeoutId);
                finalizeThumbnailLoading(card, false);
            }
        });

        video.addEventListener('error', function(e) {
            console.error(`❌ Video error for video ${videoNumber}:`, e);
            clearTimeout(timeoutId);
            finalizeThumbnailLoading(card, false);
        });

        video.addEventListener('loadstart', function() {
            console.log(`🔄 Video loading started for video ${videoNumber}`);
        });

        video.addEventListener('canplay', function() {
            console.log(`▶️ Video can play for video ${videoNumber}`);
        });

        // Start loading
        video.src = videoUrl;
    }

    // Function to finalize thumbnail loading state
    function finalizeThumbnailLoading(card, success) {
        const loadingOverlay = card.querySelector('.loading-overlay');
        const videoNumber = card.getAttribute('data-video');

        if (loadingOverlay) {
            loadingOverlay.style.opacity = '0';
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
            }, 300);
        }

        if (!success) {
            // Keep the gradient background that's already set in CSS
            console.log(`🎨 Using fallback gradient for video ${videoNumber}`);
        }

        card.classList.add('loaded');
        console.log(`🏁 Thumbnail loading finalized for video ${videoNumber}, success: ${success}`);
    }

    // Extract thumbnails for all exercise cards with staggered loading
    exerciseCards.forEach((card, index) => {
        const videoUrl = card.getAttribute('data-url');
        if (videoUrl) {
            // Stagger the loading to prevent overwhelming the browser
            setTimeout(() => {
                console.log(`🖼️ Extracting thumbnail for card ${index + 1}:`, videoUrl);
                extractThumbnail(videoUrl, card);
            }, index * 500); // 500ms delay between each thumbnail extraction
        } else {
            // If no video URL, just remove loading state
            setTimeout(() => {
                finalizeThumbnailLoading(card, false);
            }, index * 100);
        }
    });

    // Custom Player Functions
    function updatePlayPauseButton() {
        if (mainVideo.paused) {
            playPauseIcon.className = 'fa fa-play';
            playPauseIcon.style.marginLeft = '4px'; // Slight offset for play icon
            customControls.style.opacity = '1';
        } else {
            playPauseIcon.className = 'fa fa-pause';
            playPauseIcon.style.marginLeft = '0';
            customControls.style.opacity = '0';
        }
    }

    function togglePlayPause() {
        if (mainVideo.paused) {
            mainVideo.play();
            console.log('▶️ Video playing');
        } else {
            mainVideo.pause();
            console.log('⏸️ Video paused');
        }
        updatePlayPauseButton();
    }

    // Play/Pause button click handler
    if (playPauseBtn) {
        playPauseBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            togglePlayPause();
        });

        // Hover effects
        playPauseBtn.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.1)';
            this.style.background = 'rgba(255,255,255,1)';
        });

        playPauseBtn.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
            this.style.background = 'rgba(255,255,255,0.9)';
        });
    }

    // Video container click handler
    if (customControls) {
        customControls.addEventListener('click', function(e) {
            if (e.target === this) {
                togglePlayPause();
            }
        });
    }

    // Show/hide controls on video hover
    const videoPlayer = document.querySelector('.custom-video-player');
    if (videoPlayer) {
        videoPlayer.addEventListener('mouseenter', function() {
            if (mainVideo.paused) {
                customControls.style.opacity = '1';
            }
        });

        videoPlayer.addEventListener('mouseleave', function() {
            if (!mainVideo.paused) {
                customControls.style.opacity = '0';
            }
        });
    }

    // Add click listeners to exercise cards (now performance metric cards)
    exerciseCards.forEach((card, index) => {
        card.addEventListener('click', function() {
            console.log(`Performance metric card ${index + 1} clicked`);

            const videoNumber = this.getAttribute('data-video');
            const videoUrl = this.getAttribute('data-url');
            const exerciseTitle = `Übung ${videoNumber}`;

            console.log('Switching to:', { videoNumber, videoUrl, exerciseTitle });

            // Pause current video and reset controls
            if (mainVideo) {
                mainVideo.pause();
                updatePlayPauseButton();

                const source = mainVideo.querySelector('source');
                if (source) {
                    source.src = videoUrl;
                    mainVideo.load();
                    console.log('Video source updated to:', videoUrl);
                }
            }

            // Update title
            if (videoTitle) {
                videoTitle.textContent = exerciseTitle;
            }

            // Update active state
            exerciseCards.forEach(c => c.classList.remove('bg-highlight'));
            this.classList.add('bg-highlight');
        });
    });

    // Video event listeners
    if (mainVideo) {
        mainVideo.addEventListener('loadstart', () => {
            console.log('🔄 Video loading started');
            updatePlayPauseButton();
        });

        mainVideo.addEventListener('canplay', () => {
            console.log('✅ Video can play');
            updatePlayPauseButton();
        });

        mainVideo.addEventListener('play', () => {
            console.log('▶️ Video started playing');
            updatePlayPauseButton();
        });

        mainVideo.addEventListener('pause', () => {
            console.log('⏸️ Video paused');
            updatePlayPauseButton();
        });

        mainVideo.addEventListener('ended', () => {
            console.log('🏁 Video ended');
            updatePlayPauseButton();
        });

        mainVideo.addEventListener('error', (e) => {
            console.error('❌ Video error:', e);
            updatePlayPauseButton();
        });

        // Initialize button state
        updatePlayPauseButton();
    }

    // Settings Fullscreen Toggle Functionality
    function initSettingsFullscreenToggle() {
        const fullscreenToggle = document.getElementById('fullscreen-toggle');
        const fullscreenSwitch = document.getElementById('switch-fullscreen-mode');
        const fullscreenIcon = fullscreenToggle.querySelector('i');

        // Check if fullscreen is supported
        const isFullscreenSupported = document.documentElement.requestFullscreen ||
                                    document.documentElement.webkitRequestFullscreen ||
                                    document.documentElement.msRequestFullscreen;

        if (!isFullscreenSupported) {
            // Hide fullscreen option if not supported
            fullscreenToggle.style.display = 'none';
            console.log('❌ Fullscreen not supported on this device');
            return;
        }

        // Load saved fullscreen preference
        const savedFullscreenState = localStorage.getItem('fullscreen-mode') === 'true';
        fullscreenSwitch.checked = savedFullscreenState;
        updateFullscreenIcon(savedFullscreenState);

        // Apply saved state on page load
        if (savedFullscreenState) {
            // Small delay to ensure page is fully loaded
            setTimeout(() => {
                requestFullscreenMode();
            }, 1000);
        }

        // Handle toggle click
        fullscreenToggle.addEventListener('click', function(e) {
            e.preventDefault();
            toggleFullscreenMode();
        });

        // Handle switch change
        fullscreenSwitch.addEventListener('change', function() {
            toggleFullscreenMode();
        });

        function toggleFullscreenMode() {
            const isCurrentlyFullscreen = document.fullscreenElement ||
                                        document.webkitFullscreenElement ||
                                        document.msFullscreenElement;

            if (isCurrentlyFullscreen) {
                exitFullscreenMode();
            } else {
                requestFullscreenMode();
            }
        }

        function requestFullscreenMode() {
            const element = document.documentElement;

            if (element.requestFullscreen) {
                element.requestFullscreen().then(() => {
                    onFullscreenEnter();
                }).catch(err => {
                    console.warn('Fullscreen request failed:', err);
                    onFullscreenError();
                });
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
                onFullscreenEnter();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
                onFullscreenEnter();
            }
        }

        function exitFullscreenMode() {
            if (document.exitFullscreen) {
                document.exitFullscreen().then(() => {
                    onFullscreenExit();
                }).catch(err => {
                    console.warn('Exit fullscreen failed:', err);
                });
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
                onFullscreenExit();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
                onFullscreenExit();
            }
        }

        function onFullscreenEnter() {
            fullscreenSwitch.checked = true;
            updateFullscreenIcon(true);
            localStorage.setItem('fullscreen-mode', 'true');
            document.body.classList.add('fullscreen-active');
            console.log('✅ Entered fullscreen mode');
        }

        function onFullscreenExit() {
            fullscreenSwitch.checked = false;
            updateFullscreenIcon(false);
            localStorage.setItem('fullscreen-mode', 'false');
            document.body.classList.remove('fullscreen-active');
            console.log('❌ Exited fullscreen mode');
        }

        function onFullscreenError() {
            fullscreenSwitch.checked = false;
            updateFullscreenIcon(false);
            localStorage.setItem('fullscreen-mode', 'false');
            console.error('❌ Fullscreen request failed');
        }

        function updateFullscreenIcon(isFullscreen) {
            if (isFullscreen) {
                fullscreenIcon.className = 'fa font-12 fa-compress rounded-s bg-blue-dark color-white me-3';
            } else {
                fullscreenIcon.className = 'fa font-12 fa-expand rounded-s bg-blue-dark color-white me-3';
            }
        }

        // Listen for fullscreen changes (user pressing F11 or Esc)
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        document.addEventListener('msfullscreenchange', handleFullscreenChange);

        function handleFullscreenChange() {
            const isCurrentlyFullscreen = document.fullscreenElement ||
                                        document.webkitFullscreenElement ||
                                        document.msFullscreenElement;

            if (isCurrentlyFullscreen) {
                onFullscreenEnter();
            } else {
                onFullscreenExit();
            }
        }

        // Handle keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // F11 key handling
            if (e.key === 'F11') {
                e.preventDefault();
                toggleFullscreenMode();
            }

            // Ctrl/Cmd + Shift + F for fullscreen toggle
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'F') {
                e.preventDefault();
                toggleFullscreenMode();
            }
        });

        console.log('🔲 Settings fullscreen toggle initialized');
    }

    // Initialize fullscreen toggle
    initSettingsFullscreenToggle();
});
</script>

</body>
</html>
