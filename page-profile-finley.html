<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>QuoVadis</title>
<link rel="stylesheet" type="text/css" href="styles/bootstrap.css">
<link rel="stylesheet" type="text/css" href="styles/style.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i|Source+Sans+Pro:300,300i,400,400i,600,600i,700,700i,900,900i&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="manifest" href="_manifest.json" data-pwa-version="set_in_manifest_and_pwa_js">
<link rel="apple-touch-icon" sizes="180x180" href="app/icons/icon-192x192.png">
<style>

    /* Text Overlay Styles */
    .video-text-overlay {
        position: absolute;
        bottom: 20px;
        left: 20px;
        right: 20px;
        color: white;
        padding: 15px;
        border-radius: 8px;
        z-index: 3;
        transition: opacity 0.3s ease;
    }

    .video-text-overlay h1 {
        font-size: 24px;
        margin: 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        font-weight: 700;
    }

    .video-text-overlay p {
        font-size: 18px;
        margin: 5px 0 0;
        opacity: 0.9;
        text-shadow: 0 1px 2px rgba(0,0,0,0.8);
    }
</style>
</head>

<body class="theme-dark" data-highlight="highlight-blue" data-gradient="body-default">

<div id="preloader"><div class="spinner-border color-highlight" role="status"></div></div>

<div id="page">

    <div id="footer-bar" class="footer-bar-1">
        <a href="index.html"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="page-dfb.html" ><i class="fa fa-running"></i><span>DFB</span></a>
        <a href="page-profile-finley.html" class="active-nav"><i class="fa fa-futbol"></i><span>Finley</span></a>
        <a href="#" data-menu="menu-settings"><i class="fa fa-cog"></i><span>Settings</span></a>
    </div>

   <div class="page-content">
       <div class="page-content header-clear-small">
        <!-- Video Card -->
        <div class="card card-style video-card">
            <div class="video-container" style="position: relative; overflow: hidden; border-radius: 10px; height: 400px; background-color: #000;">
                <video class="responsive-video" controls style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: block;">
                    <source src="https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201_00000000.mp4" type="video/mp4">
                    Your browser doesn't support HTML5 video.
                </video>				<canvas class="video-thumbnail" style="display: none;"></canvas>
                <!-- Text Overlay for Video Info -->
                <div class="video-text-overlay">
                    <h1>Übung 1</h1>
                </div>
                <div class="video-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2; display: flex; align-items: center; justify-content: center;">
                    <div class="play-button">
                        <i class="fa fa-play fa-2x color-white"></i>
                    </div>
                </div>
            </div>
            <div class="content" style="display: none;">
                <h1 class="mb-n1">Übung 1</h1>
            </div>
        </div>

        <!-- Lift for Strength Cards -->
        <div class="card card-style mx-0">
            <div class="content">
                <a href="#" class="d-flex mb-3">
                    <div class="w-100 me-3">
                        <div class="card card-style m-0" data-card-height="110" style="background-image:url('images/fitness/13t.jpg')"></div>
                    </div>
                    <div class="ms-auto w-100">
                        <h5 class="font-600 font-16 line-height-sm pt-1">Übung 1</h5>
                        <span class="d-block font-11 font-400 opacity-60">15:00 s</span>
                        <h3 class="pt-2 mt-n1"><i class="fa fa-clock color-blue-dark pe-2"></i> 15:00 s</h3>
                    </div>
                </a>
                <div class="divider mt-3 mb-3"></div>
                <a href="#" class="d-flex mb-3">
                    <div class="w-100 me-3">
                        <div class="card card-style m-0" data-card-height="110" style="background-image:url('images/fitness/12t.jpg')"></div>
                    </div>
                    <div class="ms-auto w-100">
                        <h5 class="font-600 font-16 line-height-sm pt-1">Übung 2</h5>
                        <span class="d-block font-11 font-400 opacity-60">15:00 s</span>
                        <h3 class="pt-2 mt-n1"><i class="fa fa-clock color-blue-dark pe-2"></i> 15:00 s</h3>
                    </div>
                </a>
                <div class="divider mt-3 mb-3"></div>
                <a href="#" class="d-flex mb-3">
                    <div class="w-100 me-3">
                        <div class="card card-style m-0" data-card-height="110" style="background-image:url('images/fitness/14t.jpg')"></div>
                    </div>
                    <div class="ms-auto w-100">
                        <h5 class="font-600 font-16 line-height-sm pt-1">Übung 3</h5>
                        <span class="d-block font-11 font-400 opacity-60">15:00 s</span>
                        <h3 class="pt-2 mt-n1"><i class="fa fa-clock color-blue-dark pe-2"></i> 15:00 s</h3>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <!-- Menu Settings Highlights-->
    <div id="menu-highlights" class="menu menu-box-bottom menu-box-detached">
        <div class="menu-title"><h1>Highlights</h1><p class="color-highlight">Any Element can have a Highlight Color</p><a href="#" class="close-menu"><i class="fa fa-times"></i></a></div>
        <div class="divider divider-margins mb-n2"></div>
        <div class="content">
            <div class="highlight-changer">
                <a href="#" data-change-highlight="blue"><i class="fa fa-circle color-blue-dark"></i><span class="color-blue-light">Default</span></a>
                <a href="#" data-change-highlight="red"><i class="fa fa-circle color-red-dark"></i><span class="color-red-light">Red</span></a>
                <a href="#" data-change-highlight="orange"><i class="fa fa-circle color-orange-dark"></i><span class="color-orange-light">Orange</span></a>
                <a href="#" data-change-highlight="pink2"><i class="fa fa-circle color-pink2-dark"></i><span class="color-pink-dark">Pink</span></a>
                <a href="#" data-change-highlight="magenta"><i class="fa fa-circle color-magenta-dark"></i><span class="color-magenta-light">Purple</span></a>
                <a href="#" data-change-highlight="aqua"><i class="fa fa-circle color-aqua-dark"></i><span class="color-aqua-light">Aqua</span></a>
                <a href="#" data-change-highlight="teal"><i class="fa fa-circle color-teal-dark"></i><span class="color-teal-light">Teal</span></a>
                <a href="#" data-change-highlight="mint"><i class="fa fa-circle color-mint-dark"></i><span class="color-mint-light">Mint</span></a>
                <a href="#" data-change-highlight="green"><i class="fa fa-circle color-green-light"></i><span class="color-green-light">Green</span></a>
                <a href="#" data-change-highlight="grass"><i class="fa fa-circle color-green-dark"></i><span class="color-green-dark">Grass</span></a>
                <a href="#" data-change-highlight="sunny"><i class="fa fa-circle color-yellow-light"></i><span class="color-yellow-light">Sunny</span></a>
                <a href="#" data-change-highlight="yellow"><i class="fa fa-circle color-yellow-dark"></i><span class="color-yellow-light">Goldish</span></a>
                <a href="#" data-change-highlight="brown"><i class="fa fa-circle color-brown-dark"></i><span class="color-brown-light">Wood</span></a>
                <a href="#" data-change-highlight="night"><i class="fa fa-circle color-dark-dark"></i><span class="color-dark-light">Night</span></a>
                <a href="#" data-change-highlight="dark"><i class="fa fa-circle color-dark-light"></i><span class="color-dark-light">Dark</span></a>
                <div class="clearfix"></div>
            </div>
            <a href="#" data-menu="menu-settings" class="mb-3 btn btn-full btn-m rounded-sm bg-highlight shadow-xl text-uppercase font-900 mt-4">Back to Settings</a>
        </div>
    </div>
    <!-- Menu Settings Backgrounds-->
    <div id="menu-backgrounds" class="menu menu-box-bottom menu-box-detached">
        <div class="menu-title"><h1>Backgrounds</h1><p class="color-highlight">Change Page Color Behind Content Boxes</p><a href="#" class="close-menu"><i class="fa fa-times"></i></a></div>
        <div class="divider divider-margins mb-n2"></div>
        <div class="content">
            <div class="background-changer">
                <a href="#" data-change-background="default"><i class="bg-theme"></i><span class="color-dark-dark">Default</span></a>
                <a href="#" data-change-background="plum"><i class="body-plum"></i><span class="color-plum-dark">Plum</span></a>
                <a href="#" data-change-background="magenta"><i class="body-magenta"></i><span class="color-dark-dark">Magenta</span></a>
                <a href="#" data-change-background="dark"><i class="body-dark"></i><span class="color-dark-dark">Dark</span></a>
                <a href="#" data-change-background="violet"><i class="body-violet"></i><span class="color-violet-dark">Violet</span></a>
                <a href="#" data-change-background="red"><i class="body-red"></i><span class="color-red-dark">Red</span></a>
                <a href="#" data-change-background="green"><i class="body-green"></i><span class="color-green-dark">Green</span></a>
                <a href="#" data-change-background="sky"><i class="body-sky"></i><span class="color-sky-dark">Sky</span></a>
                <a href="#" data-change-background="orange"><i class="body-orange"></i><span class="color-orange-dark">Orange</span></a>
                <a href="#" data-change-background="yellow"><i class="body-yellow"></i><span class="color-yellow-dark">Yellow</span></a>
                <div class="clearfix"></div>
            </div>
            <a href="#" data-menu="menu-settings" class="mb-3 btn btn-full btn-m rounded-sm bg-highlight shadow-xl text-uppercase font-900 mt-4">Back to Settings</a>
        </div>
    </div>
    <!-- Menu Share -->
    <div id="menu-share" class="menu menu-box-bottom menu-box-detached">
        <div class="menu-title mt-n1"><h1>Share the Love</h1><p class="color-highlight">Just Tap the Social Icon. We'll add the Link</p><a href="#" class="close-menu"><i class="fa fa-times"></i></a></div>
        <div class="content mb-0">
            <div class="divider mb-0"></div>
            <div class="list-group list-custom-small list-icon-0">
                <a href="auto_generated" class="shareToFacebook external-link">
                    <i class="font-18 fab fa-facebook-square color-facebook"></i>
                    <span class="font-13">Facebook</span>
                    <i class="fa fa-angle-right"></i>
                </a>
                <a href="auto_generated" class="shareToTwitter external-link">
                    <i class="font-18 fab fa-twitter-square color-twitter"></i>
                    <span class="font-13">Twitter</span>
                    <i class="fa fa-angle-right"></i>
                </a>
                <a href="auto_generated" class="shareToLinkedIn external-link">
                    <i class="font-18 fab fa-linkedin color-linkedin"></i>
                    <span class="font-13">LinkedIn</span>
                    <i class="fa fa-angle-right"></i>
                </a>
                <a href="auto_generated" class="shareToWhatsApp external-link">
                    <i class="font-18 fab fa-whatsapp-square color-whatsapp"></i>
                    <span class="font-13">WhatsApp</span>
                    <i class="fa fa-angle-right"></i>
                </a>
                <a href="auto_generated" class="shareToMail external-link border-0">
                    <i class="font-18 fa fa-envelope-square color-mail"></i>
                    <span class="font-13">Email</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </div>
        </div>
    </div>

</div>

<script type="text/javascript" src="scripts/bootstrap.min.js"></script>
<script type="text/javascript" src="scripts/custom.js"></script>
<script type="text/javascript" src="js/components/timer-text-component.js"></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    'use strict'

    // Image fallback functionality
    const preloadImages = document.querySelectorAll('.preload-img[data-fallback]');

    preloadImages.forEach(function(element) {
        const primarySrc = element.getAttribute('data-src');
        const fallbackSrc = element.getAttribute('data-fallback');

        // Test if primary image loads
        const testImg = new Image();
        testImg.onload = function() {
            // Primary image loaded successfully, use it
            element.style.backgroundImage = `url('${primarySrc}')`;
        };
        testImg.onerror = function() {
            // Primary image failed, use fallback
            element.style.backgroundImage = `url('${fallbackSrc}')`;
            element.setAttribute('data-src', fallbackSrc);
        };
        testImg.src = primarySrc;
    });

    // Video card functionality
    const videoCards = document.querySelectorAll('.video-card');

    // Track which video is currently playing
    const videoStates = {
        VIDEO_1: 'https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201_00000000.mp4',
        VIDEO_2: 'https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201x00000000.mp4',
        VIDEO_3: 'https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201xxs00000000.mp4',
        VIDEO_4: 'https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201xx00000000.mp4',
        current: 'https://data3.fra1.cdn.digitaloceanspaces.com/Timeline%201_00000000.mp4',
        currentIndex: 1
    };    // Timer related functions removed

    function loadNextVideo(card) {
        const video = card.querySelector('video');
        const source = video.querySelector('source');
        const textOverlay = card.querySelector('.video-text-overlay');

        if (video && source) {
            // Pause current video
            video.pause();

            // Update current index
            videoStates.currentIndex = (videoStates.currentIndex % 4) + 1;

            // Set the next video based on the current index
            switch(videoStates.currentIndex) {
                case 1:
                    source.src = videoStates.VIDEO_1;
                    videoStates.current = videoStates.VIDEO_1;
                    break;
                case 2:
                    source.src = videoStates.VIDEO_2;
                    videoStates.current = videoStates.VIDEO_2;
                    break;
                case 3:
                    source.src = videoStates.VIDEO_3;
                    videoStates.current = videoStates.VIDEO_3;
                    break;
                case 4:
                    source.src = videoStates.VIDEO_4;
                    videoStates.current = videoStates.VIDEO_4;
                    break;
            }

            // Update text overlay to show what's coming next
            if (textOverlay) {
                const nextIndex = (videoStates.currentIndex % 4) + 1;
                const titleElement = textOverlay.querySelector('h1');
                const subtitleElement = textOverlay.querySelector('p');

                if (titleElement) {
                    titleElement.textContent = 'Übung ' + videoStates.currentIndex;
                }
            }            // Load and play the new video
            video.load();
            video.play();

            // Timer functionality removed

            // Make sure video is visible and overlay is hidden
            if (card.thumbnailImg) {
                card.thumbnailImg.style.display = 'none';
            }

            const overlay = card.querySelector('.video-overlay');
            if (overlay) {
                overlay.style.opacity = '0';
            }

            video.style.display = 'block';
            video.classList.add('playing');
        }
    }    function stopVideoTimer(card) {
        // Timer functionality removed
    }

    // Initialize any new video cards that might not have all required elements
    videoCards.forEach(function(card) {
        // Make sure the card has the necessary elements
        if(!card.querySelector('.video-overlay')) {
            const videoContainer = card.querySelector('.video-container');
            if(videoContainer) {
                const overlay = document.createElement('div');
                overlay.className = 'video-overlay';
                overlay.style.cssText = 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2; display: flex; align-items: center; justify-content: center;';

                const playButton = document.createElement('div');
                playButton.className = 'play-button';
                playButton.innerHTML = '<i class="fa fa-play fa-2x color-white"></i>';

                overlay.appendChild(playButton);
                videoContainer.appendChild(overlay);
            }
        }

        // Make sure the card has a canvas for thumbnails
        if(!card.querySelector('.video-thumbnail')) {
            const videoContainer = card.querySelector('.video-container');
            if(videoContainer) {
                const canvas = document.createElement('canvas');
                canvas.className = 'video-thumbnail';
                canvas.style.display = 'none';
                videoContainer.appendChild(canvas);
            }
        }
    });

    // Home Workout functionality
    let workoutTimer = null;
    let workoutStartTime = 0;
    let workoutElapsedTime = 0;
    let workoutPaused = false;
    let currentExerciseDuration = 15 * 60; // 15 minutes default

    const exercises = {
        'push-ups': { name: 'Push-Up Challenge', duration: 15 * 60, video: 'images/players/bent.m.mp4' },
        'squats': { name: 'Squats', duration: 5 * 60, video: 'images/players/vgl-b-f.MP4' },
        'planks': { name: 'Planks', duration: 3 * 60, video: 'images/players/bent.m.mp4' },
        'burpees': { name: 'Burpees', duration: 4 * 60, video: 'images/players/vgl-b-f.MP4' }
    };

    let currentExercise = 'push-ups';

    // Workout timer functions
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    function updateWorkoutTimer() {
        const timerElement = document.getElementById('workout-timer');
        if (timerElement) {
            const elapsed = formatTime(workoutElapsedTime);
            const total = formatTime(currentExerciseDuration);
            timerElement.textContent = `${elapsed} / ${total}`;
        }
    }

    function startWorkoutTimer() {
        if (!workoutPaused) {
            workoutStartTime = Date.now() - (workoutElapsedTime * 1000);
        } else {
            workoutStartTime = Date.now() - (workoutElapsedTime * 1000);
            workoutPaused = false;
        }

        workoutTimer = setInterval(() => {
            workoutElapsedTime = Math.floor((Date.now() - workoutStartTime) / 1000);
            updateWorkoutTimer();

            if (workoutElapsedTime >= currentExerciseDuration) {
                pauseWorkoutTimer();
            }
        }, 1000);
    }

    function pauseWorkoutTimer() {
        if (workoutTimer) {
            clearInterval(workoutTimer);
            workoutTimer = null;
            workoutPaused = true;
        }
    }

    function resetWorkoutTimer() {
        if (workoutTimer) {
            clearInterval(workoutTimer);
            workoutTimer = null;
        }
        workoutElapsedTime = 0;
        workoutPaused = false;
        updateWorkoutTimer();
    }

    // Main video player functionality
    function initMainVideoPlayer() {
        const mainVideo = document.getElementById('main-workout-video');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const videoProgress = document.getElementById('video-progress');
        const videoTime = document.getElementById('video-time');
        const overlay = document.getElementById('main-video-overlay');

        if (!mainVideo) return;

        // Update video time and progress
        mainVideo.addEventListener('timeupdate', function() {
            if (mainVideo.duration) {
                const progress = (mainVideo.currentTime / mainVideo.duration) * 100;
                if (videoProgress) videoProgress.style.width = progress + '%';

                if (videoTime) {
                    const current = formatTime(Math.floor(mainVideo.currentTime));
                    const duration = formatTime(Math.floor(mainVideo.duration));
                    videoTime.textContent = `${current} / ${duration}`;
                }
            }
        });

        // Play/pause functionality
        function togglePlayPause() {
            if (mainVideo.paused) {
                mainVideo.play();
                if (playPauseBtn) playPauseBtn.innerHTML = '<i class="fa fa-pause"></i>';
                if (overlay) overlay.style.opacity = '0';
            } else {
                mainVideo.pause();
                if (playPauseBtn) playPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
                if (overlay) overlay.style.opacity = '1';
            }
        }

        // Event listeners
        if (overlay) overlay.addEventListener('click', togglePlayPause);
        if (playPauseBtn) playPauseBtn.addEventListener('click', togglePlayPause);
        mainVideo.addEventListener('click', togglePlayPause);
    }

    // Switch exercise function
    function switchExercise(exerciseKey) {
        const exercise = exercises[exerciseKey];
        if (!exercise) return;

        currentExercise = exerciseKey;
        currentExerciseDuration = exercise.duration;

        // Update UI
        const titleElement = document.getElementById('current-exercise-title');
        if (titleElement) titleElement.textContent = exercise.name;

        // Update main video
        const mainVideo = document.getElementById('main-workout-video');
        if (mainVideo) {
            mainVideo.pause();
            mainVideo.querySelector('source').src = exercise.video;
            mainVideo.load();
        }

        // Reset timer
        resetWorkoutTimer();

        // Reset video controls
        const playPauseBtn = document.getElementById('play-pause-btn');
        const overlay = document.getElementById('main-video-overlay');
        if (playPauseBtn) playPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
        if (overlay) overlay.style.opacity = '1';
    }

    // Function to extract thumbnail from video
    function extractThumbnail(video, canvas, time = 1) {
        return new Promise((resolve, reject) => {
            const tempVideo = document.createElement('video');
            tempVideo.crossOrigin = 'anonymous';
            tempVideo.muted = true;
            tempVideo.preload = 'metadata';

            tempVideo.addEventListener('loadedmetadata', function() {
                tempVideo.currentTime = Math.min(time, tempVideo.duration * 0.1); // 10% into video or 1 second
            });

            tempVideo.addEventListener('seeked', function() {
                try {
                    const ctx = canvas.getContext('2d');
                    canvas.width = tempVideo.videoWidth;
                    canvas.height = tempVideo.videoHeight;
                    ctx.drawImage(tempVideo, 0, 0, canvas.width, canvas.height);

                    // Convert canvas to blob and create object URL
                    canvas.toBlob(function(blob) {
                        const thumbnailUrl = URL.createObjectURL(blob);
                        resolve(thumbnailUrl);
                    }, 'image/jpeg', 0.8);
                } catch (error) {
                    reject(error);
                }
            });

            tempVideo.addEventListener('error', function() {
                reject(new Error('Failed to load video for thumbnail extraction'));
            });

            tempVideo.src = video.querySelector('source').src;
        });
    }

    // Set proper aspect ratio for video containers
    function setVideoContainerAspectRatio() {
        const videoContainers = document.querySelectorAll('.video-container');
        videoContainers.forEach(function(container) {
            const video = container.querySelector('video');

            if (video) {
                // Create a temporary video element to get the natural dimensions
                const tempVideo = document.createElement('video');
                tempVideo.preload = 'metadata';

                tempVideo.onloadedmetadata = function() {
                    // Calculate aspect ratio
                    const aspectRatio = tempVideo.videoHeight / tempVideo.videoWidth;

                    // Set container padding-top based on aspect ratio to maintain it
                    // This is the percentage padding trick for responsive aspect ratios
                    container.style.paddingTop = (aspectRatio * 100) + '%';

                    // Clean up
                    tempVideo.remove();
                };

                // Load just the metadata
                tempVideo.src = video.querySelector('source').src;
            }
        });
    }

    videoCards.forEach(function(card) {
        const video = card.querySelector('video');
        const canvas = card.querySelector('.video-thumbnail');
        const overlay = card.querySelector('.video-overlay');
        const playButton = card.querySelector('.play-button');

        if (video && canvas && overlay && playButton) {
            // Extract and set thumbnail
            extractThumbnail(video, canvas)
                .then(function(thumbnailUrl) {
                    // Create thumbnail image element
                    const thumbnailImg = document.createElement('img');
                    thumbnailImg.src = thumbnailUrl;
                    thumbnailImg.className = 'video-thumbnail';
                    thumbnailImg.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; display: block;';

                    // Insert thumbnail before overlay
                    card.querySelector('.video-container').insertBefore(thumbnailImg, overlay);

                    // Store reference for later removal
                    card.thumbnailImg = thumbnailImg;
                })
                .catch(function(error) {
                    console.warn('Failed to extract thumbnail:', error);
                    // Fallback: show video element directly
                    video.style.display = 'block';
                });

            // Handle card click to play/pause video
            card.addEventListener('click', function(e) {
                e.preventDefault();

                if (video.paused) {
                    // Pause all other videos first
                    videoCards.forEach(function(otherCard) {
                        const otherVideo = otherCard.querySelector('video');
                        if (otherVideo && !otherVideo.paused) {
                            otherVideo.pause();
                            // Show thumbnail again
                            if (otherCard.thumbnailImg) {
                                otherCard.thumbnailImg.style.display = 'block';
                            }
                            otherVideo.classList.remove('playing');
                            otherCard.querySelector('.video-overlay').style.opacity = '';
                        }
                    });

                    // Update the current video state based on the source
                    const source = video.querySelector('source');
                    if (source) {
                        // Extract the filename from the src attribute
                        const srcPath = source.getAttribute('src');
                        const filename = srcPath.split('/').pop();
                        videoStates.current = filename;
                    }

                    // Hide thumbnail and play video
                    if (card.thumbnailImg) {
                        card.thumbnailImg.style.display = 'none';
                    }                    video.style.display = 'block'; // Make sure video is visible
                    video.classList.add('playing');
                    video.play();
                    overlay.style.opacity = '0';

                    // Timer functionality removed
                } else {
                    video.pause();
                    // Show thumbnail again
                    if (card.thumbnailImg) {
                        card.thumbnailImg.style.display = 'block';
                    }
                    video.classList.remove('playing');
                    overlay.style.opacity = '';

                    // Timer functionality removed
                }
            });

            // Handle video ended event
            video.addEventListener('ended', function() {
                overlay.style.opacity = '';
                video.currentTime = 0; // Reset to beginning
                video.classList.remove('playing');
                // Show thumbnail again
                if (card.thumbnailImg) {
                    card.thumbnailImg.style.display = 'block';
                }

                // Timer functionality removed
            });

            // Handle video pause event
            video.addEventListener('pause', function() {
                overlay.style.opacity = '';
                video.classList.remove('playing');
                // Show thumbnail again
                if (card.thumbnailImg) {
                    card.thumbnailImg.style.display = 'block';
                }

                // Timer functionality removed
            });

            // Handle video play event
            video.addEventListener('play', function() {
                overlay.style.opacity = '0';
                video.classList.add('playing');
                // Hide thumbnail
                if (card.thumbnailImg) {
                    card.thumbnailImg.style.display = 'none';
                }                // Timer functionality removed
            });

            // Handle direct video clicks for play/pause
            video.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                // Toggle play/pause when clicking directly on video
                if (video.paused) {
                    // Pause all other videos first
                    videoCards.forEach(function(otherCard) {
                        const otherVideo = otherCard.querySelector('video');
                        if (otherVideo && !otherVideo.paused) {
                            otherVideo.pause();
                            // Show thumbnail again
                            if (otherCard.thumbnailImg) {

                                otherCard.thumbnailImg.style.display = 'block';
                            }
                            otherVideo.classList.remove('playing');
                            otherCard.querySelector('.video-overlay').style.opacity = '';
                        }
                    });

                    // Hide thumbnail and play video
                    if (card.thumbnailImg) {
                        card.thumbnailImg.style.display = 'none';
                    }
                    video.classList.add('playing');
                    video.play();                    overlay.style.opacity = '0';

                    // Timer functionality removed
                } else {
                    video.pause();
                    // Show thumbnail again
                    if (card.thumbnailImg) {
                        card.thumbnailImg.style.display = 'block';
                    }
                    video.classList.remove('playing');
                    overlay.style.opacity = '';

                    // Timer functionality removed
                }
            });
        }
    });

    // Tab control functionality
    const tabControls = document.querySelectorAll('.tab-controls a[data-bs-toggle="collapse"]');

    tabControls.forEach(function(tabControl) {
        tabControl.addEventListener('click', function(e) {
            e.preventDefault();

            // Get the target tab content
            const targetId = this.getAttribute('data-bs-target');
            const targetTab = document.querySelector(targetId);

            if (targetTab) {
                // Pause all videos when switching away from DFB tab
                if (!targetId.includes('dfb')) {
                    videoCards.forEach(function(card) {
                        const video = card.querySelector('video');
                        if (video && !video.paused) {
                            video.pause();
                            // Show thumbnail again
                            if (card.thumbnailImg) {
                                card.thumbnailImg.style.display = 'block';
                            }
                            video.classList.remove('playing');
                            const overlay = card.querySelector('.video-overlay');
                            if (overlay) {
                                overlay.style.opacity = '';
                            }
                        }
                    });
                }

                // Handle Bootstrap collapse manually
                const parentId = targetTab.getAttribute('data-bs-parent');
                const parent = document.querySelector(parentId);

                if (parent) {
                    // Hide all other tabs in the same group
                    const allTabs = parent.querySelectorAll('.collapse');
                    allTabs.forEach(function(tab) {
                        if (tab !== targetTab) {
                            tab.classList.remove('show');
                        }
                    });

                    // Show the target tab
                    targetTab.classList.add('show');

                    // Update active state on tab controls
                    const allTabControls = parent.parentElement.querySelectorAll('.tab-controls a');
                    allTabControls.forEach(function(control) {
                        control.removeAttribute('data-active');
                    });
                    this.setAttribute('data-active', '');
                }
            }
        });
    });

    // Initialize home workout functionality
    initMainVideoPlayer();
    updateWorkoutTimer();

    // Timer control event listeners
    const timerStartBtn = document.getElementById('timer-start');
    const timerPauseBtn = document.getElementById('timer-pause');
    const timerResetBtn = document.getElementById('timer-reset');

    if (timerStartBtn) {
        timerStartBtn.addEventListener('click', startWorkoutTimer);
    }

    if (timerPauseBtn) {
        timerPauseBtn.addEventListener('click', pauseWorkoutTimer);
    }

    if (timerResetBtn) {
        timerResetBtn.addEventListener('click', resetWorkoutTimer);
    }

    // Exercise preview click handlers
    const exercisePreviews = document.querySelectorAll('.exercise-preview');
    exercisePreviews.forEach(function(preview) {
        preview.addEventListener('click', function(e) {
            e.preventDefault();
            const exerciseKey = this.getAttribute('data-exercise');
            if (exerciseKey) {
                switchExercise(exerciseKey);
            }
        });
    });

    // Add video card functionality to preview videos
    const previewVideos = document.querySelectorAll('.preview-video');
    previewVideos.forEach(function(container) {
        const video = container.querySelector('video');
        const canvas = container.querySelector('.video-thumbnail');
        const overlay = container.querySelector('.video-overlay');

        if (video && canvas && overlay) {
            // Extract and set thumbnail for preview videos
            extractThumbnail(video, canvas)
                .then(function(thumbnailUrl) {
                    const thumbnailImg = document.createElement('img');
                    thumbnailImg.src = thumbnailUrl;
                    thumbnailImg.className = 'video-thumbnail';
                    thumbnailImg.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; display: block;';

                    container.insertBefore(thumbnailImg, overlay);
                })
                .catch(function(error) {
                    console.warn('Failed to extract preview thumbnail:', error);
                });
        }
    });

    // Set proper aspect ratio for video containers
    setVideoContainerAspectRatio();
});
</script>
</body>
